# 优化后的提示词格式

## 原版格式
```xml
[输出格式]
<stories>
  <story>
    <number>故事脑洞的序号，从1开始计数</number>
    <synopsis>对小说脑洞的概括</synopsis>
    <zhihu_title>小说脑洞的标题内容</zhihu_title>
  </story>
</stories>
```

## 优化版格式（推荐）

### 版本1：标题优先版 ⭐️ 最推荐
```xml
[输出格式]
<stories>
  <story>
    <id>故事序号，从1开始</id>
    <title>小说标题</title>
    <content>小说脑洞概要</content>
  </story>
</stories>

[内容示例]
<stories>
  <story>
    <id>1</id>
    <title>我把宿敌撩哭了</title>
    <content>高冷学霸天天针对我，我赌气说"你是不是喜欢我？"他嗤笑一声。三天后，我真撩他撩到眼眶发红，声音颤抖："你别再对我这么好了，好不好？</content>
  </story>
  <story>
    <id>2</id>
    <title>和前男友假扮情侣后我真上头了</title>
    <content>为了应付家长催婚，我和前男友假扮情侣，住进同一屋檐下。他却在深夜认真看着我说："这次我不会再错过你。"</content>
  </story>
</stories>
```

### 版本2：极简版（传输效率高）
```xml
[输出格式]
<stories>
  <s>
    <n>序号</n>
    <t>标题</t>
    <c>内容</c>
  </s>
</stories>

[内容示例]
<stories>
  <s>
    <n>1</n>
    <t>我把宿敌撩哭了</t>
    <c>高冷学霸天天针对我，我赌气说"你是不是喜欢我？"他嗤笑一声。三天后，我真撩他撩到眼眶发红，声音颤抖："你别再对我这么好了，好不好？</c>
  </s>
  <s>
    <n>2</n>
    <t>和前男友假扮情侣后我真上头了</t>
    <c>为了应付家长催婚，我和前男友假扮情侣，住进同一屋檐下。他却在深夜认真看着我说："这次我不会再错过你。"</c>
  </s>
</stories>
```

### 版本3：兼容原版（最小改动）
```xml
[输出格式]
<stories>
  <story>
    <number>故事序号</number>
    <title>小说标题</title>
    <synopsis>小说概要</synopsis>
  </story>
</stories>

[内容示例]
<stories>
  <story>
    <number>1</number>
    <title>我把宿敌撩哭了</title>
    <synopsis>高冷学霸天天针对我，我赌气说"你是不是喜欢我？"他嗤笑一声。三天后，我真撩他撩到眼眶发红，声音颤抖："你别再对我这么好了，好不好？</synopsis>
  </story>
  <story>
    <number>2</number>
    <title>和前男友假扮情侣后我真上头了</title>
    <synopsis>为了应付家长催婚，我和前男友假扮情侣，住进同一屋檐下。他却在深夜认真看着我说："这次我不会再错过你。"</synopsis>
  </story>
</stories>
```

## 🎯 改进要点说明

### 1. 字段顺序优化
- **原版**：number → synopsis(长) → zhihu_title
- **优化**：id → title(短) → content(长)
- **原因**：用户最关心标题，应该先看到

### 2. 标签名称简化
| 原标签 | 新标签 | 说明 |
|--------|--------|------|
| number | id | 更短，语义清晰 |
| zhihu_title | title | 去掉平台前缀 |
| synopsis | content | 更通用的名称 |

### 3. 流式解析优势
```javascript
// 优化后的解析更简单
if (buffer.endsWith('<title>')) {
    // 立即开始显示标题
    startTypewriterEffect();
}

// 标题短，能快速显示完
// 然后开始显示较长的content
```

## 💡 使用建议

1. **如果后端可以修改**：使用版本1（标题优先版）
2. **如果需要极致性能**：使用版本2（极简版）
3. **如果不能改后端**：使用版本3（兼容版）

## 🚀 前端解析代码示例

```javascript
// 针对优化版本1的解析
function processOptimizedXML(buffer) {
    // 1. 检测story开始
    if (buffer.endsWith('<story>')) {
        createEmptyCard();
        return;
    }
    
    // 2. 检测id（立即显示编号）
    if (buffer.match(/<id>(\d+)<\/id>/)) {
        updateCardNumber(RegExp.$1);
    }
    
    // 3. 检测title开始（优先显示）
    if (buffer.endsWith('<title>')) {
        parserState.currentTag = 'title';
        parserState.buffer = '';
    }
    
    // 4. title内容逐字显示
    if (parserState.currentTag === 'title' && !buffer.includes('</title>')) {
        appendCharToTitle(buffer[buffer.length - 1]);
    }
    
    // 5. content同理...
}
```

## 📊 性能对比

| 指标 | 原版 | 优化版1 | 优化版2 |
|------|------|---------|---------|
| 首字显示时间 | 慢 | 快 | 最快 |
| 解析复杂度 | 中 | 低 | 最低 |
| 用户体验 | 一般 | 好 | 好 |
| 代码维护性 | 一般 | 好 | 中 |

推荐使用**版本1（标题优先版）**，平衡了各方面的需求！